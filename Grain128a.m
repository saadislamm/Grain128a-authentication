clear all;clc;
tic;


%564b3622
a = [0 1 0 1 0 1 1 0 0 1 0 0 1 0 1 1 0 0 1 1 0 1 1 0 0 0 1 0 0 0 1 0];                          %   a = Accumulator

%19bd90e3
r = [0 0 0 1 1 0 0 1 1 0 1 1 1 1 0 1 1 0 0 1 0 0 0 0 1 1 1 0 0 0 1 1];                          %   r = Register

%0d2b1f2ebc83da7e 6658ee3150f9ef47
%keystream = [0 0 0 0 1 1 0 1 0 0 1 0 1 0 1 1 0 0 0 1 1 1 1 1 0 0 1 0 1 1 1 0 1 0 1 1 1 1 0 0 1 0 0 0 0 0 1 1 1 1 0 1 1 0 1 0 0 1 1 1 1 1 1 0 0 1 1 0 0 1 1 0 0 1 0 1 1 0 0 0 1 1 1 0 1 1 1 0 0 0 1 1 0 0 0 1 0 1 0 1 0 0 0 0 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 1 0 1 0 0 0 1 1 1];

%1cdbc7f1e52da547 36fa252828de82a0
macstream = [0 0 0 1 1 1 0 0 1 1 0 1 1 0 1 1 1 1 0 0 0 1 1 1 1 1 1 1 0 0 0 1 1 1 1 0 0 1 0 1 0 0 1 0 1 1 0 1 1 0 1 0 0 1 0 1 0 1 0 0 0 1 1 1 0 0 1 1 0 1 1 0 1 1 1 1 1 0 1 0 0 0 1 0 0 1 0 1 0 0 1 0 1 0 0 0 0 0 1 0 1 0 0 0 1 1 0 1 1 1 1 0 1 0 0 0 0 0 1 0 1 0 1 0 0 0 0 0];

m = [];                                                                                         % m0
tag(a, r, m, macstream)
m = 0;                                                                                          % m1
tag(a, r, m, macstream)
m = 1;                                                                                          % m2
tag(a, r, m, macstream)
m = [0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0 0 0 0 0];                                                  % m3 = 12340
tag(a, r, m, macstream)
m = [0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0 0 1 0 1 0 1 1 0 0 1 1 1 1 0 0 0 1 0 0 1 1 1 1 0 1];        % m4 = 123456789e8
tag(a, r, m, macstream)

toc;

%   Expected Results
%   tag(m0) | | 4ff6a6c1
%   tag(m1) | | 653017e4
%   tag(m2) | | 7c8d8707
%   tag(m3) | | 522ab34f
%   tag(m4) | | 4b7821c9